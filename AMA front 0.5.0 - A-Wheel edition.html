<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academia Magica Apocalyptica Character Sheet</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        /* Base styles */
        body {
            font-family: "Bookman Old Style", Georgia, serif;
            max-width: 11in;
            margin: 0 auto;
            padding: 20px;
            background-color: #f0f0f0;
        }
        
        /* Layout */
        .page {
            display: grid;
            grid-template-columns: .85fr 1.3fr 0.8fr;
            gap: 20px;
            border: 5px double #000;
            padding: 20px;
            background-color: white;
            margin-bottom: 40px;
        }
        
        /* Common styles */
        .section {
            border: 1px solid #000;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .dotted-line {
            border-bottom: 1px dotted #000;
            height: 1.5em;
            margin: 5px 0;
        }
        
        .checkbox {
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid #000;
            margin-right: 5px;
        }
        
        /* Header styles */
        .title {
            grid-column: 1 / -1;
            text-align: center;
            font-size: 28px;
            margin-bottom: 9px;
            letter-spacing: 4px;
            padding: 10px 0;
        }
        
        .title::before, .title::after {
            content: "✧ ❈ ✧";
            font-size: 20px;
            padding: 0px 22px;
            color: #333;
        }
        
        .setting {
            grid-column: 1 / -1;
            text-align: center;
            font-style: italic;
            margin-bottom: 20px;
            padding: 15px;
            border-top: 1px solid #000;
            border-bottom: 1px solid #000;
            line-height: 1.4;
        }
        
        /* Section headers */
        .section-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .section-title::before, .section-title::after {
            content: "✧";
            margin: 0 10px;
        }
        
        /* Stats styling */
        .stat-row {
            text-align: center;
            margin: 15px 0;
        }
        
        .stat-name {
            display: inline-block;
            margin-right: 10px;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .die-placeholder {
            display: inline-block;
            color: #999;
            font-style: italic;
            font-size: 1.2em;
        }
        
        .specializations {
            margin-top: 8px;
            display: flex;
            justify-content: center;
            gap: 20px;
            font-size: 0.9em;
        }
        
        /* Utility classes */
        .instructions {
            font-style: italic;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
        
        .success-tiers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .token-box {
            width: 100px;
            height: 100px;
            border: 2px solid #000;
            margin: 10px auto;
        }

        /* Circle Visualization styles */
        #visualization {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 0 auto;
            width: fit-content;
            margin-bottom: 0px;
        }

        .curved-text {
            font-size: 14px;
            fill: #333;
        }

        .viz-container {
            /* grid-column: 1 / -1; */
            display: flex;

            /* margin-top: 20px; */
            /* padding: 20px; */
            border: 1px solid #000;
        }

        @page {
            size: portrait;
            margin: 0.47in;
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="title">✧ ACADEMIA MAGICA APOCALYPTICA ✧</div>
        <div class="setting">"While competing at the _________ Battle Royale, something went catastrophically wrong, hurling you and your competitors X00 years into a ruined future. All around you lies an apocalyptic wasteland, where survival means trusting your former rivals. Together, you must uncover what happened that day - and find a way back home."</div>
        
        <div>
            <div class="section">
                <div class="section-title">Character Info</div>
                <div>Name:<div class="dotted-line"></div></div>
                <div>School:<div class="dotted-line"></div></div>
                <div>House:<div class="dotted-line"></div></div>
                <div>Appearance:<div class="dotted-line"></div></div>
            </div>        
            <div class="section">
                <div class="section-title">Rolling Dice</div>
                <ul style="font-size: 0.9em; margin: 0; padding-left: 20px;">
                    <li>Roll and sum up two stat dice - one you pick, one the GM picks (can match).</li>
                    <li>Add +1 for each applicable style under those stats.</li>
                    <li>Success determined by tiers listed above.</li>
                    <li>Anima tokens can modify results.</li>
                </ul>
            </div>
            <div class="section">
                <div class="section-title">Schools of Magic</div>
                <div class="instructions"> A.M.A. is genre- and culture-agnostic regarding types of magic. Just make sure to stick to one character concept.</div>
                <ul style="font-size: 0.9em; margin: 0; padding-left: 20px;">
                    <li>A reflexive minor illusion may be Mystique + Instinct. </li>
                    <li>A complex ritual spell might be Acumen + Craft. </li>
                    <li>Primal shapeshifting might be Grit + ?, based on the type of creature. </li>
                    <li>Any stat(s) could be used for defense depending on how you are evading/blocking.</li>
                </ul>
            </div> 
            <div class="section">
                <div class="section-title">Downtime</div>
                <div class="instructions" style="margin: 0">Roll all dice: consider Need #s.</div>
                <div class="instructions" style="margin: 0">Make 2 personal(ity) changes:</div>
                <ul style="font-size: 0.9em; margin: 0; padding-left: 20px;">
                    <li>Rerank a need.</li>                    
                    <li>Swap a style or pair of dice.</li>
                    <li>Console and make a friend.</li>
                </ul> 
                <div class="instructions" style="margin-bottom:0">Then, set your anima to [ 9 - Angst + Number of Friends]</div>
            </div>
            <div class="section-credits">
                <div class="section-title">v. 0.5.0</div>
                <div class="instructions" style="margin-bottom:0; text-align:center">Psynapshots, January 17, 2025</div>


            </div>  
        </div>

        <div>
            <div class="section">
                <div class="section-title">Core Stats</div>
                <div class="instructions">Assign one unique die (d4/d6/d8/d10/d12) to each stat. Choose one style per stat (does not imply absence of the other).</div>
                
                <div class="stat-row">
                    <div><span class="stat-name">Mystique</span><span class="die-placeholder">d___</span></div>
                    <div class="specializations">
                        <span><div class="checkbox"></div>Graceful</span>
                        <span><div class="checkbox"></div>Mysterious</span>
                    </div>
                </div>
                <div class="stat-row">
                    <div><span class="stat-name">Acumen</span><span class="die-placeholder">d___</span></div>
                    <div class="specializations">
                        <span><div class="checkbox"></div>Astute</span>
                        <span><div class="checkbox"></div>Rigorous</span>
                    </div>
                </div>
                <div class="stat-row">
                    <div><span class="stat-name">Grit</span><span class="die-placeholder">d___</span></div>
                    <div class="specializations">
                        <span><div class="checkbox"></div>Tenacious</span>
                        <span><div class="checkbox"></div>Adaptive</span>
                    </div>
                </div>
                <div class="stat-row">
                    <div><span class="stat-name">Instinct</span><span class="die-placeholder">d___</span></div>
                    <div class="specializations">
                        <span><div class="checkbox"></div>Mindful</span>
                        <span><div class="checkbox"></div>Courageous</span>
                    </div>
                </div>
                <div class="stat-row">
                    <div><span class="stat-name">Craft</span><span class="die-placeholder">d___</span></div>
                    <div class="specializations">
                        <span><div class="checkbox"></div>Resourceful</span>
                        <span><div class="checkbox"></div>Visionary</span>
                    </div>
                </div>
            </div>

            <div class="section">
                <div class="section-title">Success Tiers</div>
                <div class="success-tiers">
                    <div>7+ Costly</div>
                    <div>16+ Greater</div>
                    <div>10+ Lesser</div>
                    <div>19+ Extraordinary</div>
                    <div>13+ Solid</div>
                    <div>22+ Aetheric</div>
                </div>
            </div>
            <div class="section">
                <div class="section-title">Circle of Psychological Needs</div>
                <div class="instructions">Denote in each circle the rank order of its corresponding Need from most volatile (1) to most stable (9). Start with 6 needs met (checked). The number of unmet needs in the largest contiguous chain is your <u>Angst score</u>, which you may denote in the center.</div>
                <div id="visualization"></div>
            </div>

            <div class="section-credits">
            </div>
        </div>

        <div>

            <div class="section">
                <div class="section-title">Anima Tokens</div>
                <div class="instructions">Gained from fulfilling needs, resting, items, and <u>on failed checks</u>. Spend 1:1 to boost your friend's rolls; 2:1 to help others. Casting magic always consumes anima(e). Start: 9.</div>
                <div class="token-box"></div>
            </div>
            <div class="section">
                <div class="section-title">Taking Hits</div>
                <ul style="font-size: 0.9em; margin: 0; padding-left: 20px;">
                    <li>Unfulfill a need. </li>                    
                    <li>Lose confidence in a style. </li>
                    <li>Reduce a stat die to d6.</li>
                    <li>Test/Break a friendship. </li>
                </ul>
            </div>
            <div class="section">
                <div class="section-title">Friends</div>
                <div class="instructions">Record their name and how you gained each others' trust.</div>
                <div>Friend 1: <span style="opacity:.3"><i>Yourself(?)</i></span><div class="dotted-line"></div></div>
                <div>Friend 2: <div class="dotted-line"></div></div>
                <div>Friend 3: <div class="dotted-line"></div></div>
                <div>Friend 4: <div class="dotted-line"></div></div>
                <div>Friend 5: <div class="dotted-line"></div></div>
                <div>Friend 6: <div class="dotted-line"></div></div>
                <div>Friend 7: <div class="dotted-line"></div></div>
            </div>
            <div class="section">
                <div class="section-title">Angst (max 5)</div>
                <div class="instructions" style="margin-bottom:0">Take a hit, go solo, and risk defeat: + Angst to your roll.</div>
            </div>   
        </div>
        
       
    </div>

    <script>
        // Create SVG container
        const svg = d3.select("#visualization")
            .append("svg")
            .attr("width", 400)
            .attr("height", 300);

        // Add defs for our text paths
        const defs = svg.append("defs");

        // Calculate the radius of each circle
        const circleRadius = 44;
        const ringRadius = .53*circleRadius / Math.sin(Math.PI / 9);

        // Create center point of the ring
        const centerX = 200;
        const centerY = 150;

        // Sample text for each circle with custom start angles (in degrees)
        const circleData = [
            { text: "aspiration", textStartAngle: 333 },
            { text: "awe", textStartAngle: 345 },
            { text: "authenticity", textStartAngle: 313 },
            { text: "affection", textStartAngle: 333 },
            { text: "acceptance", textStartAngle: 322 },
            { text: "allegiance", textStartAngle: -30 },
            { text: "autonomy", textStartAngle: -35 },
            { text: "aptitude", textStartAngle: 322 },
            { text: "accomplishment", textStartAngle: 300 }
        ];

        // Generate complete data for 9 circles, each 40 degrees apart
        const completeCircleData = circleData.map((data, i) => {
            const angle = (i * 40) * (Math.PI / 180); // Convert degrees to radians
            return {
                x: centerX + ringRadius * Math.cos(angle),
                y: centerY + ringRadius * Math.sin(angle),
                angle: angle,
                text: data.text,
                textStartAngle: data.textStartAngle,
                id: `circle-${i}`
            };
        });

        // Create circular paths for text
        completeCircleData.forEach(d => {
            // Create a circular path around each circle
            const textPathRadius = circleRadius + 5; // Slightly larger than circle radius
            
            // Calculate the start point of the arc using the custom textStartAngle
            const startAngle = d.angle + (d.textStartAngle * Math.PI / 180);
            const textPath = defs.append("path")
                .attr("id", d.id)
                .attr("d", `
                    M ${d.x + textPathRadius * Math.cos(startAngle)},
                      ${d.y + textPathRadius * Math.sin(startAngle)}
                    A ${textPathRadius} ${textPathRadius} 0 1 1
                      ${d.x + textPathRadius * Math.cos(startAngle - 0.01)},
                      ${d.y + textPathRadius * Math.sin(startAngle - 0.01)}
                `);
        });

        // Create groups for circles and their text
        const groups = svg.selectAll("g")
            .data(completeCircleData)
            .enter()
            .append("g");

        // Draw the circles
        groups.append("circle")
            .attr("cx", d => d.x)
            .attr("cy", d => d.y)
            .attr("r", circleRadius)
            .attr("fill", "grey")
            .attr("fill-opacity", ".07")
            .attr("stroke", "none")
            .attr("stroke-width", 1);

        // Add text that follows the circular paths
        groups.append("text")
            .attr("class", "curved-text")
            .attr("dy", -2) // Adjust text position relative to path
            .append("textPath")
            .attr("href", d => `#${d.id}`)
            .attr("startOffset", "0%")
            .text(d => d.text);

        // Add checkboxes
        const checkboxGroups = groups.append("g")
            .attr("class", "checkbox")
            .attr("transform", d => {
                // Calculate position for checkbox
                const textPathRadius = circleRadius + 30; // Position outside the text
                const checkboxAngle = d.angle + Math.PI / 180; // Adjust angle to position after text
                const x = d.x + textPathRadius * Math.cos(checkboxAngle);
                const y = d.y + textPathRadius * Math.sin(checkboxAngle);
                return `translate(${x},${y})`;
            })
            ;

        // Add the checkbox rectangles
        checkboxGroups.append("rect")
            .attr("x", -6)
            .attr("y", -6)
            .attr("width", 12)
            .attr("height", 12)
            // .attr("rx", 2)
            // .attr("ry", 2)
            .attr("fill", "white")
            .attr("stroke", "black");
    </script>
</body>
</html>